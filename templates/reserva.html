{% extends 'base.html' %}

{% block content %}
<!-- Use este tuto https://www.w3schools.com/howto/howto_css_fullscreen_video.asp -->

<div class="reserva__background">
    <video autoplay loop muted class="background__video">
        <source src="{{ url_for('static', filename='videos/fondo_reserva.mp4') }}" type="video/mp4">
    </video>
</div>

{% if paquete %}
<section class="reserva-personalizada__section">
    <div class="reserva-personalizada__content">
        <h1 class="reserva-personalizada__title">Reservar Paquete: {{ paquete.name }}</h1>

        <div class="package-details-summary">
            <p><strong>Descripción:</strong> {{ paquete.description | replace('\n', '<br />') | safe }}</p>
            <p><strong>Duración:</strong> {{ paquete.nights }} noches</p>
            {% if paquete.room_type %}
            <p><strong>Tipo de Habitación:</strong> {{ paquete.room_type.name }}</p>
            {% endif %}
            {% if paquete.activities %}
            <p><strong>Actividades Incluidas:</strong>
                <ul>
                    {% for activity in paquete.activities %}
                    <li>{{ activity.name }}</li>
                    {% endfor %}
                </ul>
            </p>
            {% endif %}
            {% if paquete.services %}
            <p><strong>Servicios Incluidos:</strong>
                <ul>
                    {% for service in paquete.services %}
                    <li>{{ service.name }}</li>
                    {% endfor %}
                </ul>
            </p>
            {% endif %}
            <p class="package-price"><strong>Precio Total del Paquete:</strong> ${{ paquete.price }}</p>
        </div>

        <form class="reserva-paquete__form" id="form-reserva-paquete" action="{{ url_for('reserva.reserva') }}" method="POST"
              data-paquete-id="{{ paquete.id }}"
              data-room-type-id="{{ paquete.room_type.id if paquete.room_type else '' }}"
              data-nights="{{ paquete.nights }}">
            <div class="form-personalizada__group">
                <div class="form-personalizada__group-item">
                    <label for="checkin-paquete">Check-in</label>
                    <input type="date" id="checkin-paquete" name="checkin_date" required>
                </div>
                <div class="form-personalizada__group-item">
                    <label for="checkout-paquete">Check-out (automático)</label>
                    <input type="date" id="checkout-paquete" name="checkout_date" readonly>
                </div>
            </div>
            <div class="form-personalizada__group">
                <div class="form-personalizada__group-item">
                    <label for="adults-paquete">Adultos</label>
                    <input type="number" id="adults-paquete" name="adults" min="1" value="2" required>
                </div>
                <div class="form-personalizada__group-item">
                    <label for="children-paquete">Menores</label>
                    <input type="number" id="children-paquete" name="children" min="0" value="0" required>
                </div>
            </div>
            <div class="form-personalizada__group">
                <div class="form-personalizada__group-item">
                    <label for="name-paquete">Nombre Completo</label>
                    <input type="text" id="name-paquete" name="customer_name" required>
                </div>
                <div class="form-personalizada__group-item">
                    <label for="email-paquete">Email</label>
                    <input type="email" id="email-paquete" name="customer_email" required>
                </div>
            </div>
            <div id="availability-message" style="margin-top: 1rem; text-align: center; font-weight: bold;"></div>
            <button type="submit" id="btn-reservar-paquete" class="form-personalizada__button" disabled>¡Reservar Paquete!</button>
        </form>
    </div>
</section>
{% else %}
<section class="reserva-personalizada__section">
    <div class="reserva-personalizada__content">
        <h1 class="reserva-personalizada__title">Reservá tu estadía</h1>
        <form class="reserva-personalizada__form" action="{{ url_for('reserva.reserva') }}" method="POST" data-backend-url="{{ public_backend_url }}">
            <div class="form-personalizada__group">
                <div class="form-personalizada__group-item">
                    <label for="checkin">Check-in</label>
                    <input type="date" id="checkin" name="checkin" required>
                </div>
                <div class="form-personalizada__group-item">
                    <label for="checkout">Check-out</label>
                    <input type="date" id="checkout" name="checkout" required>
                </div>
            </div>
            <div class="form-personalizada__group">
                <div class="form-personalizada__group-item">
                    <label for="room">Habitacion</label>
                    <select name="room" id="room" required>
                        <option value="" disabled selected>Tipo de habitación</option>
                        {% for room in data.rooms %}
                        <option value="{{ room.id }}">{{ room.nombre }}</option>
                        {% endfor %}
                    </select>
                </div>
            </div>
            <div class="form-personalizada__group">
                <div class="form-personalizada__group-item">
                    <label for="adults">Adultos</label>
                    <input type="number" id="adults" name="adults" min="1" value="2" required>
                </div>
                <div class="form-personalizada__group-item">
                    <label for="children">Menores</label>
                    <input type="number" id="children" name="children" min="0" value="0" required>
                </div>
            </div>
            <div class="form-personalizada__group">
                <div class="form-personalizada__group-item">
                    <label for="services-list">Servicios</label>
                    <p class="form-personalizada__helper">Elegí uno o varios servicios para sumar a tu estadía.</p>
                    <div class="form-checkboxes" id="services-list">
                        {% for service in data.services %}
                        <label class="form-checkboxes__item">
                            <input type="checkbox" name="services" value="{{ service.id }}">
                            {{ service.nombre }}
                        </label>
                        {% endfor %}
                    </div>
                </div>
            </div>
            <div class="form-personalizada__group">
                <div class="form-personalizada__group-item">
                    <label for="activities-list">Actividades</label>
                    <p class="form-personalizada__helper">Podés seleccionar todas las actividades que quieras.</p>
                    <div class="form-checkboxes" id="activities-list">
                        {% for activity in data.activities %}
                        <label class="form-checkboxes__item">
                            <input type="checkbox" name="activities" value="{{ activity.id }}">
                            {{ activity.nombre }}
                        </label>
                        {% endfor %}
                    </div>
                </div>
            </div>
            <div class="form-personalizada__group">
                <div class="form-personalizada__group-item">
                    <label for="name">Nombre Completo</label>
                    <input type="text" id="name" name="name" required>
                </div>
                <div class="form-personalizada__group-item">
                    <label for="email">Email</label>
                    <input type="email" id="email" name="email" required>
                </div>
            </div>
            <button type="submit" class="form-personalizada__button">¡Reserva Ya!</button>
        </form>
    </div>
</section>
{% endif %}

{% endblock %}

{% block scripts %}
{% if paquete %}
<script src="{{ url_for('static', filename='scripts/reserva_paquete.js') }}"></script>
{% else %}
<script src="{{ url_for('static', filename='scripts/reserva.js') }}"></script>
{% endif %}
{% endblock %}